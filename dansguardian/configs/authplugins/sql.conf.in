# IP+SQL auth plugin
#
# Maps client IPs to filter groups according to the result of an SQL query.

plugname = 'sqlauth'

# ipgroups file
# List file assigning RADIUS groups to filter groups
# (or more generally, the result of sqlauthusergroupquery to filter groups)
sqlauthgroups = '@DGCONFDIR@/lists/authplugins/sqlgroups'

sqlauthdb     = 'mysql'
sqlauthdbhost = 'localhost'
sqlauthdbname = 'radius'
sqlauthdbuser = 'radius'
sqlauthdbpass = 'radius'

# In case of conflict the most recent entry can be chosen
sqlauthipuserquery = 'SELECT `username` FROM `radacct` WHERE `acctstoptime` IS NULL AND `framedipaddress` = "-IPADDRESS-" ORDER BY `acctstarttime` DESC'

# In case of conflict the highest priority result can be chosen
sqlauthusergroupquery = 'SELECT `groupname` FROM `radusergroup` WHERE `username` = "-USERNAME-" ORDER BY `priority` ASC'
